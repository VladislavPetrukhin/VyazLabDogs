<!doctype html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <title>Добавить собаку (подробно)</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
        <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon_dog.ico') }}" />
    </head>
    <body>
        <h1>Добавить собаку (подробный режим)</h1>
         <nav>
        <a href="/">Главная</a> |
        <a href="/add_detailed">Добавить</a> |
        <a href="/stats">Статистика</a> |
        <a href="/sync_queries">Поиск по атрибутам</a>
    </nav>

        {% if errors %}
        <ul class="errors">
            {% for error in errors %}
            <li>{{ error }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        <form method="POST" id="dogForm">
            <h2>Информация о собаке</h2>
            <label for="name">Кличка:</label><br />
            <input type="text" name="name" id="name" required /><br />
            <label for="birth_date">Дата рождения:</label><br />
            <input type="date" name="birth_date" id="birth_date" /><br />
            <label for="registration_date">Дата регистрации:</label><br />
            <input type="date" name="registration_date" id="registration_date" /><br />
            <label for="microchip_number">Номер микрочипа:</label><br />
            <input type="text" name="microchip_number" id="microchip_number" /><br />

            <label for="breeds_id">Порода:</label><br />
            <select name="breeds_id" id="breeds_id">
                <option value="">-- Выберите породу --</option>
                {% for breed in breeds %}
                <option value="{{ breed.id }}">{{ breed.breed_name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#breedModal">Добавить</button><br />

            <label for="location_id">Место размещения:</label><br />
            <select name="location_id" id="location_id">
                <option value="">-- Выберите место --</option>
                {% for location in locations %}
                <option value="{{ location.id }}">{{ location.location_name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#locationModal">Добавить</button><br />

            <label for="getting_id">Получение:</label><br />
            <select name="getting_id" id="getting_id">
                <option value="">-- Выберите --</option>
                {% for getting in gettings %}
                <option value="{{ getting.id }}">{{ getting.getting_by }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#gettingModal">Добавить</button><br />

            <label for="vet_examinations_id">Ветеринарный осмотр:</label><br />
            <select name="vet_examinations_id" id="vet_examinations_id">
                <option value="">-- Выберите --</option>
                {% for vet in vet_examinations %}
                <option value="{{ vet.id }}">{{ vet.examination_date }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#vetModal">Добавить</button><br />

            <label for="coat_type">Тип шерсти:</label><br />
            <select name="coat_type" id="coat_type">
                <option value="">-- Выберите --</option>
                {% for ct in coat_types %}
                <option value="{{ ct.id }}">{{ ct.coat_type_name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#coatTypeModal">Добавить</button><br />

            <label for="color_variations">Окрас:</label><br />
            <select name="color_variations" id="color_variations">
                <option value="">-- Выберите --</option>
                {% for cv in color_variations %}
                <option value="{{ cv.id }}">{{ cv.color_variations_name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#colorModal">Добавить</button><br />

            <label for="temperament">Темперамент:</label><br />
            <select name="temperament" id="temperament">
                <option value="">-- Выберите --</option>
                {% for t in temperaments %}
                <option value="{{ t.id }}">{{ t.temperament_name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#temperamentModal">Добавить</button><br />

            <label for="size">Размер:</label><br />
            <select name="size" id="size">
                <option value="">-- Выберите --</option>
                {% for s in sizes %}
                <option value="{{ s.id }}">{{ s.size_name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#sizeModal">Добавить</button><br />

            <button type="submit">Добавить собаку</button>
        </form>

        <!-- Модальное окно для породы -->
        <div class="modal fade" id="breedModal" tabindex="-1" role="dialog" aria-labelledby="breedModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="breedModalLabel">Добавить породу</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="breed_name">Название породы:</label>
                        <input type="text" id="breed_name" class="form-control" /><br />
                        <label for="breed_group">Группа породы:</label>
                        <input type="text" id="breed_group" class="form-control" /><br />
                        <label for="origin_country">Страна происхождения:</label>
                        <input type="text" id="origin_country" class="form-control" /><br />
                        <label for="average_lifes">Средняя продолжительность жизни:</label>
                        <input type="number" id="average_lifes" class="form-control" /><br />
                        <label for="typical_use">Типичное использование:</label>
                        <input type="text" id="typical_use" class="form-control" /><br />
                        <label for="common_health_issues">Проблемы со здоровьем:</label>
                        <input type="text" id="common_health_issues" class="form-control" /><br />
                        <label for="recommended_vaccinations">Рекомендуемые вакцинации:</label>
                        <input type="text" id="recommended_vaccinations" class="form-control" /><br />
                        <label for="veterinary_care">Ветеринарный уход:</label>
                        <input type="text" id="veterinary_care" class="form-control" /><br />
                        <label for="average_weight_male">Средний вес самцов:</label>
                        <input type="number" id="average_weight_male" class="form-control" /><br />
                        <label for="average_weight_female">Средний вес самок:</label>
                        <input type="number" id="average_weight_female" class="form-control" /><br />
                        <label for="trainability_level">Уровень обучаемости:</label>
                        <input type="text" id="trainability_level" class="form-control" /><br />
                        <label for="recommended_training_age">Возраст начала дрессировки:</label>
                        <input type="number" id="recommended_training_age" class="form-control" /><br />
                        <label for="common_behavioral_issues">Поведенческие проблемы:</label>
                        <input type="text" id="common_behavioral_issues" class="form-control" /><br />
                        <label for="preferred_training_methods">Методы дрессировки:</label>
                        <input type="text" id="preferred_training_methods" class="form-control" /><br />
                        <label for="typical_learning_period">Период обучения:</label>
                        <input type="number" id="typical_learning_period" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addBreed()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно для места размещения -->
        <div class="modal fade" id="locationModal" tabindex="-1" role="dialog" aria-labelledby="locationModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="locationModalLabel">Добавить место</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="location_name">Название места:</label>
                        <input type="text" id="location_name" class="form-control" /><br />
                        <label for="location_type">Тип места:</label>
                        <input type="text" id="location_type" class="form-control" /><br />
                        <label for="address">Адрес:</label>
                        <input type="text" id="address" class="form-control" /><br />
                        <label for="contact_info">Контактная информация:</label>
                        <input type="text" id="contact_info" class="form-control" /><br />
                        <label for="price">Стоимость:</label>
                        <input type="number" id="price" class="form-control" /><br />
                        <label for="availability">Количество собак:</label>
                        <input type="number" id="availability" class="form-control" /><br />
                        <label for="website">Сайт:</label>
                        <input type="text" id="website" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addLocation()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно для получения -->
        <div class="modal fade" id="gettingModal" tabindex="-1" role="dialog" aria-labelledby="gettingModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="gettingModalLabel">Добавить получение</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="getting_by">Кем передана:</label>
                        <input type="text" id="getting_by" class="form-control" /><br />
                        <label for="contact_info">Контактная информация:</label>
                        <input type="text" id="contact_info" class="form-control" /><br />
                        <label for="getting_type">Тип передачи:</label>
                        <input type="text" id="getting_type" class="form-control" /><br />
                        <label for="reason">Причина передачи:</label>
                        <input type="text" id="reason" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addGetting()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно для ветеринарного осмотра -->
        <div class="modal fade" id="vetModal" tabindex="-1" role="dialog" aria-labelledby="vetModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="vetModalLabel">Добавить осмотр</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="examination_date">Дата осмотра:</label>
                        <input type="date" id="examination_date" class="form-control" /><br />
                        <label for="veterinarian_name">Имя ветеринара:</label>
                        <input type="text" id="veterinarian_name" class="form-control" /><br />
                        <label for="diagnosis">Диагноз:</label>
                        <input type="text" id="diagnosis" class="form-control" /><br />
                        <label for="treatment">Лечение:</label>
                        <input type="text" id="treatment" class="form-control" /><br />
                        <label for="next_examination_date">Дата следующего осмотра:</label>
                        <input type="date" id="next_examination_date" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addVetExamination()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

<!-- Модальное окно для типа шерсти -->
        <div class="modal fade" id="coatTypeModal" tabindex="-1" role="dialog" aria-labelledby="coatTypeModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="coatTypeModalLabel">Добавить тип шерсти</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="coat_type_name">Название типа шерсти:</label>
                        <input type="text" id="coat_type_name" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addCoatType()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно для окраса -->
        <div class="modal fade" id="colorModal" tabindex="-1" role="dialog" aria-labelledby="colorModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="colorModalLabel">Добавить окрас</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="color_variations_name">Название окраса:</label>
                        <input type="text" id="color_variations_name" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addColor()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно для темперамента -->
        <div class="modal fade" id="temperamentModal" tabindex="-1" role="dialog" aria-labelledby="temperamentModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="temperamentModalLabel">Добавить темперамент</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="temperament_name">Название темперамента:</label>
                        <input type="text" id="temperament_name" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addTemperament()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Модальное окно для размера -->
        <div class="modal fade" id="sizeModal" tabindex="-1" role="dialog" aria-labelledby="sizeModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="sizeModalLabel">Добавить размер</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <label for="size_name">Название размера:</label>
                        <input type="text" id="size_name" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="button" class="btn btn-primary" onclick="addSize()">Сохранить</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script>
            function addBreed() {
                var data = {
                    breed_name: document.getElementById("breed_name").value.trim(),
                    breed_group: document.getElementById("breed_group").value.trim(),
                    origin_country: document.getElementById("origin_country").value.trim(),
                    average_lifes: document.getElementById("average_lifes").value.trim(),
                    typical_use: document.getElementById("typical_use").value.trim(),
                    common_health_issues: document.getElementById("common_health_issues").value.trim(),
                    recommended_vaccinations: document.getElementById("recommended_vaccinations").value.trim(),
                    veterinary_care: document.getElementById("veterinary_care").value.trim(),
                    average_weight_male: document.getElementById("average_weight_male").value.trim(),
                    average_weight_female: document.getElementById("average_weight_female").value.trim(),
                    trainability_level: document.getElementById("trainability_level").value.trim(),
                    recommended_training_age: document.getElementById("recommended_training_age").value.trim(),
                    common_behavioral_issues: document.getElementById("common_behavioral_issues").value.trim(),
                    preferred_training_methods: document.getElementById("preferred_training_methods").value.trim(),
                    typical_learning_period: document.getElementById("typical_learning_period").value.trim()
                };
                if (data.breed_name) {
                    fetch("/add_breed", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("breeds_id");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.breed_name;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#breedModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }

            function addLocation() {
                var data = {
                    location_name: document.getElementById("location_name").value.trim(),
                    location_type: document.getElementById("location_type").value.trim(),
                    address: document.getElementById("address").value.trim(),
                    contact_info: document.getElementById("contact_info").value.trim(),
                    price: document.getElementById("price").value.trim(),
                    availability: document.getElementById("availability").value.trim(),
                    website: document.getElementById("website").value.trim()
                };
                if (data.location_name) {
                    fetch("/add_location", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("location_id");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.location_name;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#locationModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }

            function addGetting() {
                var data = {
                    getting_by: document.getElementById("getting_by").value.trim(),
                    contact_info: document.getElementById("contact_info").value.trim(),
                    getting_type: document.getElementById("getting_type").value.trim(),
                    reason: document.getElementById("reason").value.trim()
                };
                if (data.getting_by) {
                    fetch("/add_getting", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("getting_id");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.getting_by;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#gettingModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }

            function addVetExamination() {
                var data = {
                    examination_date: document.getElementById("examination_date").value,
                    veterinarian_name: document.getElementById("veterinarian_name").value.trim(),
                    diagnosis: document.getElementById("diagnosis").value.trim(),
                    treatment: document.getElementById("treatment").value.trim(),
                    next_examination_date: document.getElementById("next_examination_date").value
                };
                if (data.examination_date) {
                    fetch("/add_vet_examination", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("vet_examinations_id");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.examination_date;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#vetModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }
            function addCoatType() {
                var data = {
                    coat_type_name: document.getElementById("coat_type_name").value.trim()
                };
                if (data.coat_type_name) {
                    fetch("/add_coat_type", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("coat_type");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.coat_type_name;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#coatTypeModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }

            function addColor() {
                var data = {
                    color_variations_name: document.getElementById("color_variations_name").value.trim()
                };
                if (data.color_variations_name) {
                    fetch("/add_color_variations", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("color_variations");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.color_variations_name;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#colorModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }

            function addTemperament() {
                var data = {
                    temperament_name: document.getElementById("temperament_name").value.trim()
                };
                if (data.temperament_name) {
                    fetch("/add_temperament", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("temperament");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.temperament_name;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#temperamentModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }

            function addSize() {
                var data = {
                    size_name: document.getElementById("size_name").value.trim()
                };
                if (data.size_name) {
                    fetch("/add_size", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                var select = document.getElementById("size");
                                var option = document.createElement("option");
                                option.value = data.id;
                                option.text = data.size_name;
                                select.appendChild(option);
                                select.value = data.id;
                                $("#sizeModal").modal("hide");
                            } else {
                                alert("Ошибка: " + data.error);
                            }
                        });
                }
            }
        </script>
    </body>
</html>
